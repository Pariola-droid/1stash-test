{"ast":null,"code":"import _objectSpread from\"C:/Users/USER/Desktop/i built react/one-stash/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/USER/Desktop/i built react/one-stash/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/USER/Desktop/i built react/one-stash/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/USER/Desktop/i built react/one-stash/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Route,Redirect}from'react-router-dom';import{callApi,apiConfigs}from'../adapter/common';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthRoute=function AuthRoute(_ref){var Component=_ref.component;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),approved=_useState2[0],setApproved=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];useEffect(function(){function req(){return _req.apply(this,arguments);}function _req(){_req=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var user,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.user){_context.next=8;break;}user=JSON.parse(localStorage.user);_context.next=4;return callApi('post',apiConfigs.apiUrl+'user/validatetoken.php',user);case 4:res=_context.sent;if(res.status===200){setApproved(true);setLoading(false);}else{setApproved(false);setLoading(false);}_context.next=10;break;case 8:setApproved(false);setLoading(false);case 10:case\"end\":return _context.stop();}}},_callee);}));return _req.apply(this,arguments);}req();},[]);for(var _len=arguments.length,rest=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){rest[_key-1]=arguments[_key];}return/*#__PURE__*/_jsx(Route,_objectSpread(_objectSpread({},rest),{},{render:function render(props){if(approved===false&&loading===false){return/*#__PURE__*/_jsx(Redirect,{to:{pathname:\"/onboard/sign-in\",state:props.location}});}else if(approved===true&&loading===false){return/*#__PURE__*/_jsx(Component,_objectSpread({},props));}else{return'';}}}));};export default AuthRoute;","map":{"version":3,"sources":["C:/Users/USER/Desktop/i built react/one-stash/src/components/authRoute.js"],"names":["React","useEffect","useState","Route","Redirect","callApi","apiConfigs","AuthRoute","Component","component","approved","setApproved","loading","setLoading","req","localStorage","user","JSON","parse","apiUrl","res","status","rest","props","pathname","state","location"],"mappings":"4oBAAA,MAAOA,CAAAA,KAAP,EAAeC,SAAf,CAA0BC,QAA1B,KAAyC,OAAzC,CACA,OAASC,KAAT,CAAgBC,QAAhB,KAAgC,kBAAhC,CACA,OAASC,OAAT,CAAkBC,UAAlB,KAAoC,mBAApC,C,2CAGA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,MAAqC,IAAxBC,CAAAA,SAAwB,MAAnCC,SAAmC,eACnBP,QAAQ,CAAC,IAAD,CADW,wCAC5CQ,QAD4C,eAClCC,WADkC,8BAErBT,QAAQ,CAAC,IAAD,CAFa,yCAE5CU,OAF4C,eAEnCC,UAFmC,eAInDZ,SAAS,CAAC,UAAM,SACCa,CAAAA,GADD,mHACd,oJACKC,YAAY,CAACC,IADlB,yBAEUA,IAFV,CAEiBC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,IAAxB,CAFjB,uBAGwBX,CAAAA,OAAO,CAAC,MAAD,CAASC,UAAU,CAACa,MAAX,CAAkB,wBAA3B,CAAqDH,IAArD,CAH/B,QAGYI,GAHZ,eAIM,GAAGA,GAAG,CAACC,MAAJ,GAAe,GAAlB,CAAsB,CAClBV,WAAW,CAAC,IAAD,CAAX,CACAE,UAAU,CAAC,KAAD,CAAV,CACH,CAHD,IAII,CACAF,WAAW,CAAC,KAAD,CAAX,CACAE,UAAU,CAAC,KAAD,CAAV,CACH,CAXP,8BAcMF,WAAW,CAAC,KAAD,CAAX,CACAE,UAAU,CAAC,KAAD,CAAV,CAfN,uDADc,sCAmBdC,GAAG,GACJ,CApBQ,CAoBN,EApBM,CAAT,CAJmD,8BAATQ,IAAS,qDAATA,IAAS,0BA0BnD,mBACI,KAAC,KAAD,gCAAWA,IAAX,MAAiB,MAAM,CAAG,gBAACC,KAAD,CAAW,CACjC,GAAGb,QAAQ,GAAG,KAAX,EAAoBE,OAAO,GAAG,KAAjC,CAAuC,CACnC,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAE,CACjBY,QAAQ,CAAE,kBADO,CAEjBC,KAAK,CAAEF,KAAK,CAACG,QAFI,CAAd,EAAP,CAIH,CALD,IAMK,IAAGhB,QAAQ,GAAG,IAAX,EAAmBE,OAAO,GAAG,KAAhC,CAAsC,CACvC,mBAAO,KAAC,SAAD,kBAAeW,KAAf,EAAP,CACH,CAFI,IAGD,CACA,MAAO,EAAP,CACH,CACJ,CAbD,GADJ,CAgBH,CA1CD,CA4CA,cAAehB,CAAAA,SAAf","sourcesContent":["import React, {useEffect, useState} from 'react'\r\nimport { Route, Redirect } from 'react-router-dom'\r\nimport { callApi, apiConfigs } from '../adapter/common'\r\n\r\n\r\nconst AuthRoute = ({component: Component}, ...rest) => {\r\n    const [approved, setApproved] = useState(true)\r\n    const [loading, setLoading] = useState(true)\r\n  \r\n    useEffect(() => {\r\n      async function req() {\r\n        if(localStorage.user){\r\n            let user = JSON.parse(localStorage.user)\r\n            const res = await callApi('post', apiConfigs.apiUrl+'user/validatetoken.php', user)\r\n            if(res.status === 200){\r\n                setApproved(true)\r\n                setLoading(false)\r\n            }\r\n            else{\r\n                setApproved(false)\r\n                setLoading(false)\r\n            }\r\n        }\r\n        else{\r\n            setApproved(false)\r\n            setLoading(false)\r\n        }\r\n      }\r\n      req()\r\n    }, []);\r\n\r\n    return (\r\n        <Route {...rest} render= {(props) => {\r\n            if(approved===false && loading===false){\r\n                return <Redirect to={{\r\n                    pathname: \"/onboard/sign-in\",\r\n                    state: props.location\r\n                }}/>\r\n            } \r\n            else if(approved===true && loading===false){\r\n                return <Component {...props}/>\r\n            }\r\n            else{\r\n                return ''\r\n            }\r\n        }} />\r\n    )\r\n}\r\n\r\nexport default AuthRoute\r\n"]},"metadata":{},"sourceType":"module"}